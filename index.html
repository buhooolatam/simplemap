<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa con Marcadores</title>
    <style>
        body, html { height: 100%; margin: 0; font-family: Arial, sans-serif; }
        header { background-color: #000; color: #fff; padding: 10px; display: flex; justify-content: space-between; align-items: center; }
        header h1 { margin: 0; }
        header button { background-color: #fff; color: #000; border: none; padding: 8px 16px; cursor: pointer; margin-left: 10px; border-radius: 5px; }
        #map { height: 90vh; width: 100%; }
        .info-window { position: relative; width: 100px; }
        .info-window button { width: 100%; background-color: #007BFF; color: white; border: none; padding: 8px; border-radius: 5px; cursor: pointer; }
        .close-btn { position: absolute; top: 5px; right: 5px; cursor: pointer; color: #888; font-weight: bold; }
    </style>
</head>
<body>
    <header>
        <h1>Buhooo</h1>
        <div>
            <button onclick="goBack()">Atr√°s</button>
            <button onclick="resetMap()">Resetear</button>
        </div>
    </header>
    <div id="map"></div>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCYaUFV_9dHJBxCmJd4GsEYsUs_26Ngq1o&callback=initMap"></script>
    <script>
        let map;

        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: -17.713042, lng: -63.180106 },
                zoom: 13
            });
            fetch('coor1.json').then(response => response.json()).then(data => {
                data.coordinates.forEach((coord, index) => {
                    const marker = new google.maps.Marker({
                        position: { lat: coord[1], lng: coord[0] },
                        map: map,
                        icon: getMarkerIcon(index)
                    });
                    google.maps.event.addListener(marker, 'click', () => {
                        const infoWindow = new google.maps.InfoWindow({
                            content: `<div class='info-window'><button onclick='redirectToGoogle()'>Registrar</button></div>`
                        });
                        infoWindow.open(map, marker);
                    });
                });
            }).catch(error => console.error('Error loading coordinates: ', error));
        }

        function getMarkerIcon(index) {
            return {
                path: google.maps.SymbolPath.CIRCLE,
                fillColor: localStorage.getItem(`marker_${index}`) ? "#FF0000" : "#D3D3D3",
                fillOpacity: 1,
                scale: 6,
                strokeColor: '#A0A0A0',
                strokeWeight: 1
            };
        }

        function redirectToGoogle() {
            window.location.href = 'https://www.google.com';
        }

        function resetMap() {
            localStorage.clear();
            console.log('Map reset.');
        }

        function goBack() {
            console.log('Back function not implemented.');
        }
    </script>
</body>
</html>
